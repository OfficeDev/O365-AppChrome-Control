!function(){"use strict";function e(e){return 0!=e.replace(/(^\s+)|(\s+$)/g,"").length?!1:!0}function n(e){var n=new RegExp("^(https?:\\/\\/)?((([a-z\\d]([a-z\\d-]*[a-z\\d])*)\\.)+[a-z]{2,}|((\\d{1,3}\\.){3}\\d{1,3}))(\\:\\d+)?(\\/[-a-z\\d%_.~+]*)*(\\?[;&a-z\\d%_.~+=-]*)?(\\#[-a-z\\d_]*)?$","i");return n.test(e)?!0:!1}window.Type&&window.Type.registerNamespace?Type.registerNamespace("Office.Controls"):(void 0===window.Office&&(window.Office={},window.Office.namespace=!0),void 0===window.Office.Controls&&(window.Office.Controls={},window.Office.Controls.namespace=!0)),Office.Controls.AppChrome=function(t,o,i,s){if("object"!=typeof o||"object"!=typeof i||!Office.Controls.Utils.isNullOrUndefined(s)&&"object"!=typeof s)return void Office.Controls.Utils.errorConsole("Invalid parameters type");if(this.rootNode=o,this.loginProvider=i,Office.Controls.Utils.isNullOrUndefined(t)||e(t)||(t.length>=50&&(t=t.substr(0,50)),this.appDisPlayName=t),Office.Controls.Utils.isNullOrUndefined(s)||(Office.Controls.Utils.isNullOrUndefined(s.appHomeUrl)||e(s.appHomeUrl)||!n(s.appHomeUrl)||(this.appHomeUrl=s.appHomeUrl),Office.Controls.Utils.isNullOrUndefined(s.customizedItems)||(this.customizedItems=s.customizedItems),!Office.Controls.Utils.isNullOrUndefined(s.onSignIn)&&Office.Controls.Utils.isFunction(s.onSignIn)&&(this.onSignIn=s.onSignIn),!Office.Controls.Utils.isNullOrUndefined(s.onSignOut)&&Office.Controls.Utils.isFunction(s.onSignOut)&&(this.onSignOut=s.onSignOut)),Office.Controls.Utils.isNullOrUndefined(i.hasLogin)||(this.isSignedIn=i.hasLogin()),this.registerinnerText(),this.renderControl(),1==this.isSignedIn){var a=this;i.getUserInfoAsync(function(e,n){Office.Controls.Utils.isNullOrUndefined(n)?(a.isSignedIn=!1,Office.Controls.Utils.errorConsole("Getting User info failed")):a.signedUserInfo=n,a.updateControl()})}else{var a=this;i.getUserInfoAsync(function(e,n){Office.Controls.Utils.isNullOrUndefined(n)?(a.isSignedIn=!1,Office.Controls.Utils.errorConsole(e)):(a.signedUserInfo=n,a.isSignedIn=!0),a.updateControl()})}},Office.Controls.AppChrome.prototype={rootNode:null,dropDownListNode:null,loginProvider:null,appDisPlayName:"3rd Party App",appHomeUrl:"#",customizedItems:null,isSignedIn:!1,signedUserInfo:null,onSignIn:function(){},onSignOut:function(){},defaultImage:"data:image/png;base64,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",registerinnerText:function(){var e={};e.isW3C=document.getElementById?!0:!1,e.isNS6=e.isW3C&&"Netscape"==navigator.appName,e.isNS6&&(HTMLElement.prototype.__defineGetter__("innerText",function(){return this.textContent}),HTMLElement.prototype.__defineSetter__("innerText",function(e){this.textContent=e}))},renderControl:function(){this.rootNode.innerHTML=Office.Controls.appChromeTemplates.generateBannerTemplate(this.appDisPlayName,this.appHomeUrl);var e=document.createElement("div");e.style.position="relative",e.innerHTML=Office.Controls.appChromeTemplates.generateDropDownList(this.customizedItems),this.rootNode.insertBefore(e,this.rootNode.childNodes[1]);var n=this;document.getElementById("O365_SubLink_ShellSignout").addEventListener("click",function(){n.onSignOut(),n.loginProvider.logout()})},updateControl:function(){var e=this,n=document.getElementById("login_user"),t=document.getElementById("_ariaId_7");0==this.isSignedIn?(this.addClass(document.getElementById("o365_ac_loginbutton"),"o365cs-me-tile-nophoto"),document.getElementById("dropdownIcon").style.display="none",document.getElementById("user_name").innerText=Office.Controls.Utils.htmlEncode(Office.Controls.appChromeResourceString.SignInString),n.addEventListener("click",function(){e.onSignIn(),e.loginProvider.login()})):(document.getElementById("user_name").innerText=Office.Controls.Utils.htmlEncode(this.signedUserInfo.displayName),null!=this.signedUserInfo.imgSrc&&(e.defaultImage=this.signedUserInfo.imgSrc),document.getElementById("login_user_image").src=this.defaultImage,document.getElementById("login_user_image").title=this.signedUserInfo.displayName,document.getElementById("image_container").style.display="table-cell",this.genInlinePersona(document.getElementById("myPersona")),n.addEventListener("click",function(n){"none"==t.style.display?t.style.display="block":t.style.display="none",e.changeTopMenuColor(),Office.Controls.Utils.cancelEvent(n)}),document.onclick=function(n){"block"==t.style.display&&(t.style.display="none",e.changeTopMenuColor())},document.oncontextmenu=function(o){o=o||event;var i=o.target||o.srcElement;if("block"==t.style.display){for(;void 0!=i&&null!=i;){if(i==t)return!0;if(i==n)break;i=i.parentNode}t.style.display="none",e.changeTopMenuColor()}})},changeTopMenuColor:function(){var e=document.getElementById("_ariaId_7");"block"==e.style.display?(this.addClass(document.getElementById("login_user"),"o365cs-personaShow"),this.removeClass(document.getElementById("login_user"),"ms-bgc-tdr-h")):(this.removeClass(document.getElementById("login_user"),"o365cs-personaShow"),this.addClass(document.getElementById("login_user"),"ms-bgc-tdr-h"))},genInlinePersona:function(e){if("object"!=typeof e)return void Office.Controls.Utils.errorConsole("Invalid parameters type");var n={};n.jobTitle=null,n.department=this.signedUserInfo.accountName,n.displayName=this.signedUserInfo.displayName,n.imgSrc=this.defaultImage,null!=this.signedUserInfo.imgSrc&&(n.imgSrc=this.signedUserInfo.imgSrc),Office.Controls.Persona.PersonaHelper.createInlinePersona(e,n)},hasClass:function(e,n){return e.className.match(new RegExp("(\\s|^)"+n+"(\\s|$)"))},addClass:function(e,n){this.hasClass(e,n)||(e.className+=" "+n)},removeClass:function(e,n){if(this.hasClass(e,n)){var t=new RegExp("(\\s|^)"+n+"(\\s|$)");e.className=e.className.replace(t," ")}}},Office.Controls.appChromeTemplates=function(){},Office.Controls.appChromeTemplates.generateBannerTemplate=function(e,n){var t='<div id="GeminiShellHeader" class="removeFocusOutline"><div autoid="_o365sg2c_k" class="o365cs-nav-header16 o365cs-base o365cs-topnavBGColor-2 o365cs-topnavBGImage" id="O365_NavHeader">';return t+=Office.Controls.appChromeTemplates.generateLeftPart(e,n),t+=Office.Controls.appChromeTemplates.generateMiddlePart(),t+=Office.Controls.appChromeTemplates.generateRightPart(),t+="</div></div>"},Office.Controls.appChromeTemplates.generateLeftPart=function(e,n){var t='<div class="o365cs-nav-leftAlign">';return t+='<div class="o365cs-nav-topItem o365cs-nav-o365Branding">',t+='<a class="o365cs-nav-bposLogo o365cs-topnavText o365cs-o365logo o365button" role="link" id="O365_MainLink_Logo" href="http://portal.office.com" aria-label="Go to your Office 365 home page"><span class="o365cs-nav-brandingText">Office 365</span></a>',t+='<div class="o365cs-nav-appTitleLine o365cs-nav-brandingText o365cs-topnavText"></div>',t+='<a class="o365cs-nav-appTitle o365cs-topnavText o365button" role="link" href="'+n+'" aria-label="Go to the App home page">',t+='<span class="o365cs-nav-brandingText" id="change_name">'+Office.Controls.Utils.htmlEncode(e)+"</a></div></div>"},Office.Controls.appChromeTemplates.generateMiddlePart=function(){var e='<div class="o365cs-nav-centerAlign"></div>';return e},Office.Controls.appChromeTemplates.generateRightPart=function(){var e='<div class="o365cs-nav-rightAlign o365cs-topnavLinkBackground-2" id="O365_TopMenu"><div>';return e+='<div class="o365cs-nav-rightMenus"><div role="banner" aria-label="User settings">',e+='<div class="o365cs-nav-topItem"><button autoid="_o365sg2c_0" type="button" class="o365cs-nav-item o365cs-nav-button ms-fcl-w o365cs-me-nav-item o365button ms-bgc-tdr-h" role="menuitem" aria-label="offline menu with submenu" aria-haspopup="true" id="login_user">',e+='<div class="o365cs-me-tileview-container" id="image_container">',e+='<div autoid="_o365sg2c_1" class="o365cs-me-tileview"><div class="o365cs-me-tileimg"><img autoid="_o365sg2c_5" class="o365cs-me-personaimg" id="login_user_image"></div></div></div>',e+='<div class="o365cs-me-tile-container"><div autoid="_o365sg2c_6" id="o365_ac_loginbutton"><div class="o365cs-me-tile-nophoto-username-container">',e+='<span autoid="_o365sg2c_8" class="o365cs-me-tile-nophoto-username o365cs-me-bidi" id="user_name"></span></div>',e+='<span class="wf-o365-x18 ms-fcl-nt o365cs-me-tile-nophoto-down owaimg wf wf-size-x18" role="presentation" id="dropdownIcon" style="display:table-cell"><div class="o365cs-me-caretDownContainer"><div class="o365cs-me-caretDown"></div></div></span></div></div>',e+="</button></div></div></div></div></div>"},Office.Controls.appChromeTemplates.generateDropDownList=function(t){var o='<div class="o365cs-nav-contextMenu o365cs-dropdownlist contextMenuPopup" ispopup="1" iscontextmenu="1" role="menu" ismodal="false" tabindex="-1" parentids="(6)" style="display: none;" id="_ariaId_7">';if(o+='<div class="o365cs-base ms-bgc-w o365cst o365cs-context-font o365cs-me-contextMenu"><div autoid="__Microsoft_O365_ShellG2_Plus_templates_cs_0" class="o365cs-me-itemsList" tabindex="-1" id="additem"><div>',o+=Office.Controls.appChromeTemplates.generatePersonaPart(),!Office.Controls.Utils.isNullOrUndefined(t)){var i=!1;for(var s in t)e(s)||e(t[s])||!n(t[s])||(o+=Office.Controls.appChromeTemplates.generateAppLinkPart(s,t[s]),i=!0);i&&(o+=Office.Controls.appChromeTemplates.generateMenuSeparator())}return o+=Office.Controls.appChromeTemplates.generateSignOutPart(),o+="</div></div></div></div>"},Office.Controls.appChromeTemplates.generatePersonaPart=function(){var e='<div autoid="__Microsoft_O365_ShellG2_Plus_templates_cs_1" tabindex="-1" aria-selected="false"><div autoid="__Microsoft_O365_ShellG2_Plus_templates_cs_2" class="o365cs-userInfo o365button" role="group" tabindex="0"><div class="o365cs-me-persona"><div class="o365cs-me-personaView" id="myPersona"></div></div></div>';return e+='<div class="o365button" role="menuitem" tabindex="0"><div style="display: none;"></div></div>',e+='<div class="o365button o365cs-contextMenuItem ms-fcl-b ms-bgc-nl-h" role="menuitem" tabindex="0" aria-label="Sign in to add another account" title="Sign in to add another account" style="display: none;"></div><div><div><div class="_fce_p ms-bcl-nl"></div></div></div></div>',e+='<div autoid="__Microsoft_O365_ShellG2_Plus_templates_cs_1" tabindex="-1"><div class="o365cs-contextMenuSeparator ms-bcl-nl"></div></div>'},Office.Controls.appChromeTemplates.generateAppLinkPart=function(e,n){e.length>=40&&(e=e.substr(0,40));var t='<div autoid="__Microsoft_O365_ShellG2_Plus_templates_cs_1" class="ms-item-tdr" tabindex="-1" aria-selected="false"><a class="o365button o365cs-contextMenuItem ms-fcl-b" role="link" href="'+n+'">';return t+='<div class="_fce_j"><span class="_fce_k owaimg" role="presentation" style="display: none;"></span><span autoid="_fce_4">'+Office.Controls.Utils.htmlEncode(e)+"</span></div></a></div>"},Office.Controls.appChromeTemplates.generateMenuSeparator=function(){var e='<div autoid="__Microsoft_O365_ShellG2_Plus_templates_cs_1" tabindex="-1"><div class="o365cs-contextMenuSeparator ms-bcl-nl"></div></div>';return e},Office.Controls.appChromeTemplates.generateSignOutPart=function(){var e='<div autoid="__Microsoft_O365_ShellG2_Plus_templates_cs_1" class="ms-item-tdr" tabindex="-1" aria-label="Sign out and return to the Sign-in page" title="Sign out and return to the Sign-in page" aria-selected="false"><a class="o365button o365cs-contextMenuItem ms-fcl-b" role="link" href="#" id="O365_SubLink_ShellSignout" aria-label="Sign out of Office 365 and return to the Sign-in page">';return e+='<div class="_fce_j"><span class="_fce_k owaimg" role="presentation" style="display: none;"></span><span autoid="_fce_4" aria-label="Sign out of Office 365 and return to the Sign-in page">'+Office.Controls.Utils.htmlEncode(Office.Controls.appChromeResourceString.SignOutString)+"</span></div></a></div>"},Office.Controls.appChromeResourceString=function(){},Office.Controls.appChromeResourceString.SignInString="Sign in",Office.Controls.appChromeResourceString.SignOutString="Sign out"}();